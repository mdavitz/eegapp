<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Responsive scaling -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Favicon (for browser tab icon) -->
  <link rel="icon" type="image/png" href="logo.png" />
  <link rel="apple-touch-icon" href="logo.png" />
  
  <!-- Open Graph meta tags -->
  <meta property="og:title" content="EEG Curriculum" />
  <meta property="og:description" content="Engaging Videos & Self-Assessment Tools" />
  <meta property="og:image" content="https://example.com/logo.png" />
  <meta property="og:url" content="https://example.com" />
  
  <title>EEG Curriculum</title>
  
  <style>
    /*-----------------------------------------------
      THEME VARIABLES & TRANSITIONS
    -----------------------------------------------*/
    :root {
      --primary-color: #003366;
      --secondary-color: #00509e;
      --accent-color: #007bff; /* used by .btn-modern */
      --bg-color: #fafafa;
      --text-color: #333;
      --info-bg: #fff;
      --border-color: #ddd;
      --header-text: #fff;
      --hover-bg: #f0f0f0;
      --shadow-color: rgba(0, 0, 0, 0.08);
      --table-header-bg: #f8f8f8;
      --dropdown-hover-bg: #f9f9f9;
      --transition-duration: 0.3s;
      --answer-bg: #e9ecef;
      --answer-hover-bg: #d6d8db;
    }
    .dark {
      --primary-color: #1a1a1a;
      --secondary-color: #333;
      --accent-color: #0099ff; /* accent changes in dark mode */
      --bg-color: #121212;
      --text-color: #eee;
      --info-bg: #1e1e1e;
      --border-color: #444;
      --header-text: #fff;
      --hover-bg: #222;
      --shadow-color: rgba(0, 0, 0, 0.3);
      --table-header-bg: #333;
      --dropdown-hover-bg: #2a2a2a;
      --answer-bg: #333;
      --answer-hover-bg: #444;
    }
    /* Always use blue header */
    header {
      background: linear-gradient(135deg, #003366, #00509e) !important;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      transform: translateZ(0);
    }

    body.large-font { font-size: 1.2em; }

    /*-----------------------------------------------
      GLOBAL RESET & BASE STYLES
    -----------------------------------------------*/
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      transition: background var(--transition-duration), color var(--transition-duration), font-size var(--transition-duration);
      padding-bottom: 80px; /* for footer */
    }

    /*-----------------------------------------------
      HEADER (Sticky with Shrink + Fade Out)
    -----------------------------------------------*/
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      color: var(--header-text);
      text-align: center;
      padding: 1.5em 1em;
      box-shadow: 0 2px 6px var(--shadow-color);
      margin-bottom: 1em;
      transition: padding 0.3s ease;
    }
    /* On shrink, remove text from flow & reduce vertical padding. */
    header.shrink {
      padding: 0.2em 1em;
    }
    header.shrink h1,
    header.shrink p {
      display: none; /* so it doesn't occupy vertical space */
    }
    .logo {
      width: 80px;
      height: auto;
      margin-bottom: 0.5em;
      display: block;
      margin-left: auto;
      margin-right: auto;
      transition: width 0.3s;
    }
    header.shrink .logo {
      width: 60px;
      margin-bottom: 0;
    }
    /* Fade out the text from 1 -> 0 over scroll=0->100px. */
    header h1, header p {
      transition: opacity 0.3s ease;
    }
    @media (max-width: 480px) {
      header {
        padding: 0.8em;
      }
    }

    /*-----------------------------------------------
      DROPDOWN NAVIGATION
    -----------------------------------------------*/
    .dropdown {
      position: relative;
      width: 100%;
      background: var(--info-bg);
      color: var(--text-color);
      border-bottom: 1px solid var(--border-color);
      padding: 0.8em 1em;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background var(--transition-duration);
      text-align: left;
      display: block;
    }
    .dropdown:hover {
      background: var(--dropdown-hover-bg);
    }
    #dropdown-label {
      display: inline-block;
    }
    .dropdown::after {
      content: "â–¼";
      float: right;
      font-size: 0.8rem;
      margin-top: 2px;
    }
    .dropdown-menu {
      display: none;
      position: absolute;
      width: 100%;
      background: var(--info-bg);
      color: var(--text-color);
      border-top: 1px solid var(--border-color);
      box-shadow: 0 2px 4px var(--shadow-color);
      z-index: 100;
      transition: opacity var(--transition-duration) ease;
    }
    .dropdown-menu div {
      padding: 0.8em 1em;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: background var(--transition-duration), transform 0.2s;
    }
    .dropdown-menu div:hover {
      background: var(--hover-bg);
      transform: scale(1.05);
    }
    .dropdown.active .dropdown-menu {
      display: block;
    }
    @media (min-width: 768px) {
      .dropdown {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #dropdown-label {
        display: none;
      }
      .dropdown::after {
        content: none;
      }
      .dropdown-menu {
        display: flex !important;
        position: static;
        border: none;
        box-shadow: none;
        width: auto;
      }
      .dropdown-menu div {
        border: none;
        padding: 10px 20px;
        margin: 0 5px;
        transition: background var(--transition-duration), transform 0.2s;
      }
      .dropdown-menu div:hover {
        background: var(--hover-bg);
        transform: scale(1.05);
      }
    }

    /*-----------------------------------------------
      MAIN CONTAINER
    -----------------------------------------------*/
    .container {
      max-width: 650px;
      margin: 0 auto;
      padding: 0 1em 2em;
    }

    /*-----------------------------------------------
      INFO BOXES & STYLING
    -----------------------------------------------*/
    .info-box {
      background: var(--info-bg);
      padding: 1.2em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      margin-bottom: 1.5em;
      transition: background var(--transition-duration);
    }
    .info-box h2 {
      margin-bottom: 0.75em;
    }

    /*-----------------------------------------------
      TABLES
    -----------------------------------------------*/
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0 20px;
    }
    table,
    th,
    td {
      border: 1px solid var(--border-color);
    }
    th,
    td {
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: var(--table-header-bg);
    }
    .pm-workflow {
      background: var(--table-header-bg);
    }

    /*-----------------------------------------------
      VIDEO LIST (Card Look)
    -----------------------------------------------*/
    .video-list {
      background: var(--info-bg);
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      margin-bottom: 1.5em;
    }
    .video-list h2 {
      margin-bottom: 0.75em;
    }
    .video-list ul {
      list-style: none;
      margin-top: 0.5em;
    }
    .video-list li {
      padding: 0.8em;
      cursor: pointer;
      border-bottom: 1px solid var(--border-color);
      transition: background var(--transition-duration);
    }
    .video-list li:hover {
      background: var(--hover-bg);
    }

    /*-----------------------------------------------
      VIDEO CONTAINER
    -----------------------------------------------*/
    .video-container {
      text-align: center;
      margin-bottom: 1.5em;
    }
    video {
      width: 100%;
      max-width: 650px;
      height: auto;
      border-radius: 8px;
      background-color: #000;
      border: 1px solid var(--border-color);
    }
    .skip-btn {
      padding: 0.75em 1.2em;
      font-size: 1rem;
      background-color: #28a745;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration);
    }
    .skip-btn:hover {
      background-color: #218838;
    }

    /*-----------------------------------------------
      QUIZ CONTAINER & FEEDBACK
    -----------------------------------------------*/
    .quiz-container {
      background: var(--info-bg);
      padding: 1.2em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      display: none;
    }
    .quiz-container h2 {
      font-size: 1.15rem;
      margin-bottom: 0.75em;
      color: var(--text-color);
    }
    .progress-indicator {
      font-size: 0.9rem;
      color: var(--text-color);
      margin-bottom: 10px;
      text-align: right;
    }
    .answers button {
      display: block;
      width: 100%;
      padding: 0.8em;
      margin: 0.5em 0;
      font-size: 1rem;
      text-align: left;
      color: var(--text-color);
      background-color: var(--answer-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.1s, background var(--transition-duration);
    }
    .answers button:hover {
      transform: scale(1.02);
      background: var(--answer-hover-bg);
    }
    .feedback {
      width: 100%;
      margin-top: 0.75em;
      font-size: 1rem;
      min-height: 1.5em;
    }
    .correct-msg,
    .incorrect-msg {
      width: 100%;
      box-sizing: border-box;
    }
    .correct-msg {
      color: #155724;
      background-color: #d4edda;
      padding: 0.5em;
      border-radius: 4px;
      border: 1px solid #c3e6cb;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .incorrect-msg {
      color: #721c24;
      background-color: #f8d7da;
      padding: 0.5em;
      border-radius: 4px;
      border: 1px solid #f5c6cb;
    }
    .buttons-row {
      margin-top: 1em;
      display: flex;
      justify-content: space-between;
      gap: 1%;
    }
    .next-btn,
    .return-btn,
    .next-section-btn {
      width: 32%;
      padding: 0.8em;
      font-size: 1rem;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration);
      text-align: center;
    }
    .next-btn {
      background-color: var(--primary-color);
    }
    .next-btn:hover {
      background-color: #002147;
    }
    .return-btn {
      background-color: #6c757d;
    }
    .return-btn:hover {
      background-color: #5a6268;
    }
    .next-section-btn {
      background-color: #17a2b8;
    }
    .next-section-btn:hover {
      background-color: #138496;
    }
    .final-score {
      text-align: center;
      margin-top: 1em;
      font-size: 1.1rem;
      font-weight: bold;
    }

    /*-----------------------------------------------
      RESPONSIVE CARD LAYOUT (Teaching Rounds Table)
    -----------------------------------------------*/
    @media (max-width: 600px) {
      .responsive-table thead {
        display: none;
      }
      .responsive-table,
      .responsive-table tbody,
      .responsive-table tr,
      .responsive-table td {
        display: block;
        width: 100%;
      }
      .responsive-table tr {
        margin-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
      }
      .responsive-table td {
        position: relative;
        padding-left: 50%;
        text-align: left;
        border: none;
        border-bottom: 1px solid var(--border-color);
      }
      .responsive-table td::before {
        content: attr(data-label);
        position: absolute;
        left: 0.8rem;
        width: 45%;
        font-weight: bold;
        white-space: nowrap;
      }
    }

    /*-----------------------------------------------
      IMAGE STYLING (For Natus Steps, ACNS, etc.)
    -----------------------------------------------*/
    .step-image {
      display: block;
      max-width: 100%;
      height: auto;
      margin: 0.75em 0;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      box-shadow: 0 2px 6px var(--shadow-color);
    }

    /*-----------------------------------------------
      KITTEN OVERLAY (Click to Dismiss)
    -----------------------------------------------*/
    .kitten-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
      opacity: 1;
      transition: opacity 0.5s ease;
    }
    .kitten-overlay img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 50%;
    }

    /*-----------------------------------------------
      EEG SLIDE GENERATOR (Behind Header/Tabs)
    -----------------------------------------------*/
    #generator {
      position: relative;
      z-index: 0;
    }

    /*-----------------------------------------------
      MODERN BUTTON STYLE (EEG Index & Milestones)
      Adapts to dark mode automatically by using
      var(--accent-color).
    -----------------------------------------------*/
    .btn-modern {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background-color: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      padding: 0.75em 1.5em;
      cursor: pointer;
      transition: filter var(--transition-duration), transform 0.2s;
    }
    .btn-modern:hover {
      transform: translateY(-2px);
      filter: brightness(0.9);
    }

    /*-----------------------------------------------
      FIXED FOOTER CONTROLS
    -----------------------------------------------*/
    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: var(--info-bg);
      border-top: 1px solid var(--border-color);
      padding: 1em;
      text-align: center;
      z-index: 2000;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-duration);
    }
    footer.show-footer {
      opacity: 1;
      pointer-events: auto;
    }
    .footer-btns {
      display: inline-flex;
      gap: 1em;
      align-items: center;
    }
    .footer-btns button {
      background: var(--accent-color);
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration);
      font-size: 0.9rem;
    }
    .footer-btns button:hover {
      background: #00509e;
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header id="header">
    <img src="logo.png" alt="EEG Logo" class="logo" />
    <h1>EEG Curriculum</h1>
    <p>Engaging Videos &amp; Self-Assessment Tools</p>
  </header>

  <!-- DROPDOWN NAVIGATION -->
  <div class="dropdown" id="dropdown">
    <span id="dropdown-label">Select Section</span>
    <div class="dropdown-menu" id="dropdown-menu">
      <div data-index="0"><i class="fa-solid fa-brain"></i> Epilepsy Rotation</div>
      <div data-index="1"><i class="fa-solid fa-info-circle"></i> Natus Instructions</div>
      <div data-index="2"><i class="fa-solid fa-file-pdf"></i> ACNS Criteria</div>
      <div data-index="3"><i class="fa-solid fa-video"></i> EEG Videos</div>
    </div>
  </div>

  <!-- MAIN CONTAINER -->
  <div class="container">
    <div id="section-content"></div>
  </div>

  <!-- FIXED FOOTER CONTROLS -->
  <footer id="footer">
    <div class="footer-btns">
      <!-- Font Size Toggle Button -->
      <button onclick="toggleFontSize()" aria-label="Toggle Font Size">
        <span style="font-size:1.4em;">A</span>/<span style="font-size:0.8em;">a</span>
      </button>
      <!-- Dark Mode Toggle Button -->
      <button onclick="toggleDarkMode()" aria-label="Toggle Dark Mode">Dark Mode</button>
    </div>
  </footer>

  <!-- PPTXGenJS for Slide Generation -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.9.0/dist/pptxgen.bundle.js"></script>

  <script>
    // Auto-detect dark mode preference
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.body.classList.add("dark");
    }

    /********************************************
     * DARK MODE & FONT SIZE FUNCTIONS
     ********************************************/
    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }
    function toggleFontSize() {
      document.body.classList.toggle("large-font");
    }

    /********************************************
     * RANDOM CAT OVERLAY (User clicks to remove)
     ********************************************/
    function showKittenOverlay() {
      const overlay = document.createElement("div");
      overlay.className = "kitten-overlay";
      overlay.addEventListener("click", () => {
        overlay.remove();
      });
      const randomParam = Date.now();
      const catImg = document.createElement("img");
      catImg.src = `https://cataas.com/cat/gif?${randomParam}`;
      catImg.alt = "Kitten Celebration!";
      overlay.appendChild(catImg);
      document.body.appendChild(overlay);
    }

    /********************************************
     * NAVIGATION LOGIC
     ********************************************/
    const dropdown = document.getElementById("dropdown");
    const dropdownMenu = document.getElementById("dropdown-menu");
    dropdown.addEventListener("click", (e) => {
      e.stopPropagation();
      dropdown.classList.toggle("active");
    });
    document.addEventListener("click", (e) => {
      if (!dropdown.contains(e.target)) {
        dropdown.classList.remove("active");
      }
    });

    let currentSectionIndex = 0;
    let currentVideoIndex = -1;
    let currentQuestionIndex = 0;
    let score = 0;

    const menuItems = document.querySelectorAll(".dropdown-menu div");
    menuItems.forEach((item) => {
      item.addEventListener("click", (e) => {
        e.stopPropagation();
        dropdown.classList.remove("active");
        let textWithoutIcon = item.textContent.replace(/^[^ ]+ /, "");
        document.getElementById("dropdown-label").textContent = textWithoutIcon;
        currentSectionIndex = parseInt(item.getAttribute("data-index"));
        currentVideoIndex = -1;
        currentQuestionIndex = 0;
        score = 0;
        renderSection();
      });
    });

    /********************************************
     * VIDEO SECTIONS (All 10 Videos + Quizzes)
     ********************************************/
    const videoSections = [
      {
        title: "Introduction to EEG",
        video: "EEG1.mp4",
        questions: [
          {
            question: "Which of the following landmarks is NOT used for EEG electrode placement?",
            answers: [
              { text: "Nasion", feedback: "Incorrect. The nasion is standard." },
              { text: "Mandibular notch", feedback: "Correct. Itâ€™s not used." },
              { text: "Inion", feedback: "Incorrect. The inion is standard." },
              { text: "Pre-auricular point", feedback: "Incorrect. Itâ€™s standard." }
            ],
            correct: 1
          },
          {
            question: "Which term describes a single EEG tracing?",
            answers: [
              { text: "Channel", feedback: "Correct!" },
              { text: "Chain", feedback: "Incorrect." },
              { text: "Montage", feedback: "Incorrect." },
              { text: "Electrode", feedback: "Incorrect." }
            ],
            correct: 0
          },
          {
            question: "Which area is least likely to show an interictal abnormality on scalp EEG?",
            answers: [
              { text: "Right frontal convexity", feedback: "Incorrect." },
              { text: "Left temporal neocortex", feedback: "Incorrect." },
              { text: "Right parietal lobe", feedback: "Incorrect." },
              { text: "Left insular cortex", feedback: "Correct." }
            ],
            correct: 3
          }
        ]
      },
      {
        title: "Polarity Rules",
        video: "EEG2.mp4",
        questions: [
          {
            question: "Which term indicates the quality of a differential amplifier?",
            answers: [
              { text: "Low-pass filter", feedback: "Incorrect." },
              { text: "Common mode rejection ratio", feedback: "Correct." },
              { text: "High-pass filter", feedback: "Incorrect." },
              { text: "Time base", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "An upward deflection indicates which scenario?",
            answers: [
              { text: "Input 1 positive vs. Input 2", feedback: "Incorrect." },
              { text: "Input 2 negative vs. Input 1", feedback: "Incorrect." },
              { text: "Input 1 negative vs. Input 2", feedback: "Correct." },
              { text: "Input 1 positive vs. ground", feedback: "Incorrect." }
            ],
            correct: 2
          },
          {
            question: "What does a phase reversal on EEG indicate?",
            answers: [
              { text: "Maximal negativity", feedback: "Correct." },
              { text: "Polarity change (neg to pos)", feedback: "Incorrect." },
              { text: "Polarity change (pos to neg)", feedback: "Incorrect." },
              { text: "Frequency change", feedback: "Incorrect." }
            ],
            correct: 0
          }
        ]
      },
      {
        title: "Montages",
        video: "EEG3.mp4",
        questions: [
          {
            question: "Which montage is bipolar?",
            answers: [
              { text: "Laplacian", feedback: "Incorrect." },
              { text: "Transverse", feedback: "Correct." },
              { text: "Ipsilateral mastoid", feedback: "Incorrect." },
              { text: "Contralateral mastoid", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "Which montage is most susceptible to reference contamination?",
            answers: [
              { text: "Anterior-posterior bipolar", feedback: "Incorrect." },
              { text: "Laplacian", feedback: "Incorrect." },
              { text: "Ipsilateral mastoid", feedback: "Incorrect." },
              { text: "Common average reference", feedback: "Correct." }
            ],
            correct: 3
          },
          {
            question: "What is a disadvantage of the Laplacian montage?",
            answers: [
              { text: "Poor for focal waveforms", feedback: "Incorrect." },
              { text: "Poor for broadly-distributed waveforms", feedback: "Correct." },
              { text: "Susceptible to eye movement artifact", feedback: "Incorrect." },
              { text: "Susceptible to reference contamination", feedback: "Incorrect." }
            ],
            correct: 1
          }
        ]
      },
      {
        title: "Eye Movements",
        video: "EEG4.mp4",
        questions: [
          {
            question: "What is the polarity of the eye?",
            answers: [
              { text: "Cornea electronegative, retina electropositive", feedback: "Incorrect." },
              { text: "Cornea electropositive, retina electronegative", feedback: "Correct." },
              { text: "Cornea neutral, retina electronegative", feedback: "Incorrect." },
              { text: "Cornea electronegative, retina neutral", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "What is Bellâ€™s phenomenon?",
            answers: [
              { text: "Slow lateral eye movements", feedback: "Incorrect." },
              { text: "Downward deviation with eye closure", feedback: "Incorrect." },
              { text: "Upward deviation with eye closure", feedback: "Correct." },
              { text: "Rapid eye movements in deep sleep", feedback: "Incorrect." }
            ],
            correct: 2
          },
          {
            question: "In which region are lateral eye movements best seen?",
            answers: [
              { text: "Anterior temporal", feedback: "Correct." },
              { text: "Frontal", feedback: "Incorrect." },
              { text: "Central", feedback: "Incorrect." },
              { text: "Occipital", feedback: "Incorrect." }
            ],
            correct: 0
          }
        ]
      },
      {
        title: "Technical Issues",
        video: "EEG5.mp4",
        questions: [
          {
            question: "What is the frequency range of theta activity in EEG?",
            answers: [
              { text: "Less than 4 Hz", feedback: "Incorrect." },
              { text: "4-7 Hz", feedback: "Correct." },
              { text: "8-13 Hz", feedback: "Incorrect." },
              { text: "More than 13 Hz", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "What does a 1 Hz low-frequency filter remove?",
            answers: [
              { text: "All activity below 1 Hz", feedback: "Incorrect." },
              { text: "Most activity below 1 Hz", feedback: "Correct." },
              { text: "All activity above 1 Hz", feedback: "Incorrect." },
              { text: "Most activity above 1 Hz", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "What is the significance of a 60 Hz artifact?",
            answers: [
              { text: "High impedance (poor connection)", feedback: "Correct." },
              { text: "Low impedance (good connection)", feedback: "Incorrect." },
              { text: "Excessive digital interference", feedback: "Incorrect." },
              { text: "Excessive muscle activity", feedback: "Incorrect." }
            ],
            correct: 0
          }
        ]
      },
      {
        title: "Normal Awake",
        video: "EEG6.mp4",
        questions: [
          {
            question: "What is the relationship of the alpha rhythm to eye closure?",
            answers: [
              { text: "Higher-voltage with eye opening", feedback: "Incorrect." },
              { text: "Lower-voltage with eye opening, higher-voltage with closure", feedback: "Correct." },
              { text: "No change", feedback: "Incorrect." },
              { text: "Higher-frequency with eye opening", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "What is an acceptable difference in alpha amplitude between hemispheres?",
            answers: [
              { text: "Left up to 50% higher than right", feedback: "Incorrect." },
              { text: "Right up to 50% higher than left", feedback: "Correct." },
              { text: "Left up to 75% higher than right", feedback: "Incorrect." },
              { text: "Right up to 75% higher than left", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "Where is the mu rhythm best seen?",
            answers: [
              { text: "Fp2", feedback: "Incorrect." },
              { text: "F8", feedback: "Incorrect." },
              { text: "C4", feedback: "Correct." },
              { text: "O4", feedback: "Incorrect." }
            ],
            correct: 2
          }
        ]
      },
      {
        title: "Normal Sleep",
        video: "EEG7.mp4",
        questions: [
          {
            question: "Which is a component of Stage I sleep?",
            answers: [
              { text: "POSTS", feedback: "Correct." },
              { text: "Sleep spindles", feedback: "Incorrect." },
              { text: "K-complexes", feedback: "Incorrect." },
              { text: "High-voltage polymorphic delta", feedback: "Incorrect." }
            ],
            correct: 0
          },
          {
            question: "Which is defining for Stage II sleep?",
            answers: [
              { text: "POSTS", feedback: "Incorrect." },
              { text: "Sleep spindles", feedback: "Correct." },
              { text: "High-voltage polymorphic delta", feedback: "Incorrect." },
              { text: "Slow rolling eye movements", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "Which awake EEG finding is most similar to POSTS?",
            answers: [
              { text: "Mu rhythm", feedback: "Incorrect." },
              { text: "Alpha rhythm", feedback: "Incorrect." },
              { text: "Eye blinks", feedback: "Incorrect." },
              { text: "Lambda waves", feedback: "Correct." }
            ],
            correct: 3
          }
        ]
      },
      {
        title: "Interictal Abnormalities",
        video: "EEG8.mp4",
        questions: [
          {
            question: "Why might some patients not show interictal abnormalities?",
            answers: [
              { text: "Superficial cortical region", feedback: "Incorrect." },
              { text: "Large area of cortex", feedback: "Incorrect." },
              { text: "Very small area of cortex", feedback: "Correct." },
              { text: "Generalized activity", feedback: "Incorrect." }
            ],
            correct: 2
          },
          {
            question: "Characteristic of focal epileptiform discharges?",
            answers: [
              { text: "No disruption of background", feedback: "Incorrect." },
              { text: "Duration > 200 ms", feedback: "Incorrect." },
              { text: "Only one phase", feedback: "Incorrect." },
              { text: "After-coming slow wave", feedback: "Correct." }
            ],
            correct: 3
          }
        ]
      },
      {
        title: "Focal Slowing",
        video: "EEG9.mp4",
        questions: [
          {
            question: "When is focal polymorphic delta most likely observed?",
            answers: [
              { text: "During an absence seizure", feedback: "Incorrect." },
              { text: "After an absence seizure", feedback: "Incorrect." },
              { text: "During a complex partial seizure", feedback: "Incorrect." },
              { text: "After a complex partial seizure", feedback: "Correct." }
            ],
            correct: 3
          },
          {
            question: "Difference between focal rhythmic and polymorphic delta?",
            answers: [
              { text: "Rhythmic delta is more epileptogenic", feedback: "Correct." },
              { text: "Polymorphic delta is more epileptogenic", feedback: "Incorrect." },
              { text: "No difference", feedback: "Incorrect." }
            ],
            correct: 0
          },
          {
            question: "What is a breach rhythm?",
            answers: [
              { text: "Increase in low-frequency activity", feedback: "Incorrect." },
              { text: "Decrease in low-frequency activity", feedback: "Incorrect." },
              { text: "Increase in high-frequency activity", feedback: "Correct." },
              { text: "Decrease in high-frequency activity", feedback: "Incorrect." }
            ],
            correct: 2
          }
        ]
      },
      {
        title: "Diffuse Slow & Periodic Discharges",
        video: "EEG10.mp4",
        questions: [
          {
            question: "Which finding indicates diffuse cerebral dysfunction?",
            answers: [
              { text: "Anterior-posterior gradient", feedback: "Incorrect." },
              { text: "Continuous background", feedback: "Incorrect." },
              { text: "Predominantly alpha waveforms", feedback: "Incorrect." },
              { text: "Unreactive background", feedback: "Correct." }
            ],
            correct: 3
          },
          {
            question: "Which pattern indicates the most severe dysfunction?",
            answers: [
              { text: "Diffuse polymorphic theta", feedback: "Incorrect." },
              { text: "Diffuse polymorphic delta", feedback: "Incorrect." },
              { text: "Diffuse attenuation", feedback: "Correct." },
              { text: "Burst-suppression", feedback: "Incorrect." }
            ],
            correct: 2
          },
          {
            question: "Significance of lateralized periodic discharges?",
            answers: [
              { text: "They are a focal seizure", feedback: "Incorrect." },
              { text: "They indicate increased seizure risk", feedback: "Correct." },
              { text: "They are not associated with risk", feedback: "Incorrect." },
              { text: "Only seen in HSV encephalitis", feedback: "Incorrect." }
            ],
            correct: 1
          }
        ]
      }
    ];

    /********************************************
     * SECTIONS ARRAY (4 Tabs)
     ********************************************/
    const sections = [
      {
        title: "Epilepsy Rotation",
        type: "info",
        content: `
          <div class="info-box">
            <h2>Epilepsy Rotation</h2>
            <h3>Daily Expectations and Goals</h3>
            <table>
              <thead>
                <tr>
                  <th>Activity</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Watch Video</td>
                  <td>Review the designated EEG video for the day.</td>
                </tr>
                <tr>
                  <td>Complete Quiz</td>
                  <td>Answer the quiz questions associated with the video.</td>
                </tr>
                <tr>
                  <td>Upload EEG</td>
                  <td>Submit one interesting EEG finding using the EEG Index button.</td>
                </tr>
                <tr>
                  <td>Review Milestones</td>
                  <td>Use the Epilepsy Milestones button to review rotation expectations.</td>
                </tr>
              </tbody>
            </table>
            <div class="btn-row" style="margin-top:1em; display:flex; gap:1em; justify-content:center;">
              <button class="btn-modern" onclick="openEEGIndexApp()">
                <i class="fa-solid fa-brain"></i> EEG Index
              </button>
              <button class="btn-modern" onclick="window.open('https://www.acgme.org/globalassets/pdfs/milestones/epilepsymilestones.pdf','_blank')">
                <i class="fa-solid fa-file-pdf"></i> Epilepsy Milestones
              </button>
            </div>
            <p style="margin-top:1em;">
              The <strong>Epilepsy Milestones</strong> document outlines the key competencies and expectations during your rotation.
            </p>
          </div>

          <div class="info-box">
            <h2>Rotation Schedule</h2>
            <h3>Inpatient Rotation (MSH &amp; MSW EMU)</h3>
            <table style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="background:var(--table-header-bg);">
                  <th style="padding:8px; border:1px solid var(--border-color);">Time</th>
                  <th style="padding:8px; border:1px solid var(--border-color);">Activity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">7-8 AM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Arrive and preround on EMU/epilepsy consult patients</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">8-9 AM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Attend morning report</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">9-10 AM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Read at least one LTM EEG, draft EEG reports</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">10 AM-12 PM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Round with epilepsy fellow/attending</td>
                </tr>
                <tr class="pm-workflow">
                  <td colspan="2" style="padding:8px; text-align:center; border:1px solid var(--border-color);">PM Workflow (~12-5pm)</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">12-1 PM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Neurology noon conference</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">1-5 PM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Elective admission H&amp;Ps, consults, follow-up on LTM EEG, read new inpatient EEGs</td>
                </tr>
              </tbody>
            </table>

            <h3>Outpatient Rotation</h3>
            <table style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="background:var(--table-header-bg);">
                  <th style="padding:8px; border:1px solid var(--border-color);">Time</th>
                  <th style="padding:8px; border:1px solid var(--border-color);">Activity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">8-9 AM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Morning report (MSH Ambulatory EEG / Outpatient PGY-2)</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">AM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Epilepsy clinic or outpatient EEG reading (self-study if no clinic)</td>
                </tr>
                <tr>
                  <td style="padding:8px; border:1px solid var(--border-color);">PM</td>
                  <td style="padding:8px; border:1px solid var(--border-color);">Resident continuity clinic or faculty clinic, ambulatory EEG readings</td>
                </tr>
                <tr>
                  <td colspan="2" style="padding:8px; border:1px solid var(--border-color);">MSW Outpatient (PGY-2): Similar schedule with assigned epilepsy clinics &amp; EEG readings</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="info-box">
            <h2>Teaching Rounds &amp; Conferences</h2>
            <p>All epilepsy conferences are currently held via Zoom (unless otherwise indicated).</p>
            <table class="responsive-table">
              <thead>
                <tr>
                  <th>Seminar</th>
                  <th>Day/Time</th>
                  <th>Location</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td data-label="Seminar">Epilepsy Surgery Conference (mandatory)</td>
                  <td data-label="Day/Time">Wed 4-5:30 PM</td>
                  <td data-label="Location">Levy Library (MSH) / Zoom</td>
                  <td data-label="Notes">Epilepsy surgery cases, comprehensive team</td>
                </tr>
                <tr>
                  <td data-label="Seminar">Teaching Rounds / Interesting EEGs (mandatory)</td>
                  <td data-label="Day/Time">Wed 1-2 PM</td>
                  <td data-label="Location">Zoom</td>
                  <td data-label="Notes">
                    1st Wed: ICU EEGs (joint with NSICU)<br/>
                    2nd &amp; 4th Wed: Faculty lecture series<br/>
                    3rd Wed: Interesting EEGs<br/>
                    5th Wed: Other topics
                  </td>
                </tr>
                <tr>
                  <td data-label="Seminar">Grand Rounds</td>
                  <td data-label="Day/Time">Fri 8-9 AM</td>
                  <td data-label="Location">Hess Center / Remote Access</td>
                  <td data-label="Notes">Neurology Grand Rounds (faculty, fellows, residents, students)</td>
                </tr>
              </tbody>
            </table>
          </div>
        `
      },
      {
        title: "Natus Instructions",
        type: "info",
        content: `
          <div class="info-box">
            <h2>Natus Instructions</h2>
            <h3>Step 1: Launch and Log In</h3>
            <p><strong>Power on the workstation</strong> and launch the Natus NeuroWorks application.<br/>
            <strong>Log in</strong> with your secure credentials (username/password).</p>
            <img src="Step1.png" alt="Step 1 Screenshot" class="step-image" />
            <br/>
            <h3>Step 2: Open a Patient Study</h3>
            <p><strong>From the main dashboard</strong>, navigate to the Patient Studies list or use the search function to locate a patient record.<br/>
            <strong>Select the desired EEG study</strong> to open it in review mode.</p>
            <img src="Step2.png" alt="Step 2 Screenshot" class="step-image" />
            <br/>
            <h3>Step 3: Configure the Display</h3>
            <p><strong>Select the bipolar montage</strong> titled <em>Bipolar LT over RT</em> from the montage menu.<br/>
            <strong>Adjust the display parameters</strong> as follows:<br/>
            &nbsp;&nbsp;â€“ Sensitivity: 7 Î¼V<br/>
            &nbsp;&nbsp;â€“ Time base: 30 (e.g., 30 mm/sec)<br/>
            &nbsp;&nbsp;â€“ High-frequency filter: 70 Hz; Low-frequency filter: 1 Hz<br/>
            &nbsp;&nbsp;â€“ Activate additional filters if required</p>
            <img src="Step3.png" alt="Step 3 Screenshot" class="step-image" />
            <br/>
            <h3>Step 4: Analyze the EEG</h3>
            <p><strong>Scroll through the recording</strong> and visually inspect the waveforms.<br/>
            <strong>Use built-in tools</strong> to assess amplitude, frequency, and duration.<br/>
            <strong>Identify patterns</strong> and add annotations for significant events.</p>
            <br/>
            <h3>Step 5: Annotate and Mark Key Events</h3>
            <p><strong>Place event markers</strong> by clicking the relevant buttons at the top of the screen.</p>
            <img src="Step5.png" alt="Step 5 Screenshot" class="step-image" />
            <br/>
            <h3>Step 6: Create an EEG Report in Epic</h3>
            <p><strong>Once the EEG review is complete</strong>, open Epicâ€™s reporting interface, generate a new report, and pend the note for review.</p>
          </div>
        `
      },
      {
        title: "ACNS Criteria",
        type: "info",
        content: `
          <div class="info-box">
            <h2 style="text-align:center;">ACNS Criteria</h2>
            <!-- ACNS PNG images replacing PDF -->
            <img src="ACNS1.png" alt="ACNS Criteria 1" class="step-image" />
            <img src="ACNS2.png" alt="ACNS Criteria 2" class="step-image" />
            <img src="ACNS3.png" alt="ACNS Criteria 3" class="step-image" />
            <img src="ACNS4.png" alt="ACNS Criteria 4" class="step-image" />
            <p style="text-align:center; margin-top:1em;">
              <strong>ACNS Criteria.</strong> ACNS Nomenclature Reference Chart.
              <a href="ACNSNomenclature2021_ReferenceChart_2020_0725ForPublicComment.pdf" target="_blank">
                <i class="fa-solid fa-link"></i> Download PDF
              </a>
            </p>
          </div>
        `
      },
      {
        title: "EEG Videos",
        type: "videoGroup",
        videoSections: videoSections,
        reference: `
          <div class="curriculum-reference" style="margin-top:1em; text-align:center;">
            <p>
              <strong>Curriculum Reference:</strong> Moeller JJ, Farooque P, Leydon G, Dominguez M, Schwartz ML, Sadler RM. A video-based introductory EEG curriculum for neurology residents. <em>MedEdPORTAL</em>. 2017;13:10570.
              <a href="https://doi.org/10.15766/mep_2374-8265.10570" target="_blank">
                <i class="fa-solid fa-link"></i> Link
              </a>
            </p>
          </div>
        `
      }
    ];

    const sectionContent = document.getElementById("section-content");

    /********************************************
     * RENDER SECTION FUNCTION
     ********************************************/
    function renderSection() {
      const section = sections[currentSectionIndex];
      if (section.type === "info") {
        // Show info content
        sectionContent.innerHTML = section.content;
      } else if (section.type === "videoGroup") {
        // Show the video list
        renderVideoList();
      } else {
        sectionContent.innerHTML = section.content;
      }
    }

    /********************************************
     * RENDER VIDEO LIST FUNCTION
     ********************************************/
    function renderVideoList() {
      const group = sections[currentSectionIndex];
      let html = `
        <div class="video-list">
          <h2>Select a Video Topic</h2>
          <ul id="video-sub-list">
      `;
      group.videoSections.forEach((vid, i) => {
        html += `<li data-vid-index="${i}">${vid.title}</li>`;
      });
      html += `</ul></div>`;

      // If there's a reference property, append it
      if (group.reference) {
        html += group.reference;
      }
      sectionContent.innerHTML = html;

      const subList = document.getElementById("video-sub-list");
      const items = subList.querySelectorAll("li");
      items.forEach(item => {
        item.addEventListener("click", () => {
          currentVideoIndex = parseInt(item.getAttribute("data-vid-index"));
          currentQuestionIndex = 0;
          score = 0;
          renderVideoSection(currentVideoIndex);
        });
      });
    }

    /********************************************
     * RENDER VIDEO SECTION FUNCTION
     ********************************************/
    function renderVideoSection(videoIdx) {
      const group = sections[currentSectionIndex];
      const vid = group.videoSections[videoIdx];
      sectionContent.innerHTML = `
        <h2 style="text-align:center; margin-bottom:1em;">${vid.title}</h2>
        <div class="video-container" id="video-container">
          <video id="video" controls>
            <source src="${vid.video}" type="video/mp4" />
            Your browser does not support the video tag.
          </video>
          <br />
          <button class="skip-btn" id="skip-btn">Skip to Quiz</button>
        </div>
        <div class="quiz-container" id="quiz-container">
          <div class="progress-indicator" id="progress-indicator"></div>
          <div id="question-container"></div>
          <div class="feedback" id="feedback"></div>
          <div class="buttons-row">
            <button class="next-btn" id="next-btn" style="display:none;">Next</button>
            <button class="return-btn" id="return-btn">Return to Video</button>
            <button class="next-section-btn" id="next-section-btn" style="display:none;">Back to Video List</button>
          </div>
          <div class="final-score" id="final-score"></div>
        </div>
        <!-- Curriculum reference appended to each video -->
        <div class="curriculum-reference" style="margin-top:1em; text-align:center;">
          <p>
            <strong>Curriculum Reference:</strong> Moeller JJ, Farooque P, Leydon G, Dominguez M, Schwartz ML, Sadler RM. A video-based introductory EEG curriculum for neurology residents. <em>MedEdPORTAL</em>. 2017;13:10570.
            <a href="https://doi.org/10.15766/mep_2374-8265.10570" target="_blank">
              <i class="fa-solid fa-link"></i> Link
            </a>
          </p>
        </div>
      `;
      setupVideoQuiz(vid);
    }

    /********************************************
     * SETUP VIDEO QUIZ FUNCTION
     ********************************************/
    function setupVideoQuiz(vid) {
      const videoEl = document.getElementById("video");
      const videoContainer = document.getElementById("video-container");
      const skipBtn = document.getElementById("skip-btn");
      const quizContainer = document.getElementById("quiz-container");
      const questionContainer = document.getElementById("question-container");
      const feedbackDiv = document.getElementById("feedback");
      const progressIndicator = document.getElementById("progress-indicator");
      const nextBtn = document.getElementById("next-btn");
      const returnBtn = document.getElementById("return-btn");
      const nextSectionBtn = document.getElementById("next-section-btn");
      const finalScoreDiv = document.getElementById("final-score");

      currentQuestionIndex = 0;
      score = 0;
      quizContainer.style.display = "none";

      // Display each question
      function showQuestion() {
        feedbackDiv.innerHTML = "";
        progressIndicator.textContent = `Question ${currentQuestionIndex + 1} of ${vid.questions.length}`;
        finalScoreDiv.textContent = "";

        const currentQ = vid.questions[currentQuestionIndex];
        questionContainer.innerHTML = `<h2 style="color: var(--text-color);">${currentQ.question}</h2>`;

        let correctChosen = false;
        const answersDiv = document.createElement("div");
        answersDiv.className = "answers";

        currentQ.answers.forEach((ansObj, idx) => {
          const btn = document.createElement("button");
          btn.textContent = ansObj.text;
          btn.addEventListener("click", () => {
            if (!correctChosen && idx === currentQ.correct) {
              correctChosen = true;
              score++;
              feedbackDiv.className = "correct-msg";
              feedbackDiv.textContent = ansObj.feedback;

              // Show cat overlay
              showKittenOverlay();

              if (currentQuestionIndex < vid.questions.length - 1) {
                nextBtn.style.display = "inline-block";
              } else {
                // Quiz done
                finalScoreDiv.textContent = `Your score: ${score} out of ${vid.questions.length}`;
                nextSectionBtn.textContent = "Back to Video List";
                nextSectionBtn.style.display = "inline-block";
              }
            } else if (idx === currentQ.correct) {
              feedbackDiv.className = "correct-msg";
              feedbackDiv.textContent = ansObj.feedback;
            } else {
              feedbackDiv.className = "incorrect-msg";
              feedbackDiv.textContent = ansObj.feedback;
            }
          });
          answersDiv.appendChild(btn);
        });
        questionContainer.appendChild(answersDiv);
      }

      // If video ends, show quiz
      videoEl.addEventListener("ended", () => {
        videoContainer.style.display = "none";
        quizContainer.style.display = "block";
        showQuestion();
      });
      // Skip to quiz
      skipBtn.addEventListener("click", () => {
        videoEl.pause();
        videoContainer.style.display = "none";
        quizContainer.style.display = "block";
        showQuestion();
      });
      // Next question
      nextBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();

        currentQuestionIndex++;
        if (currentQuestionIndex < vid.questions.length) {
          showQuestion();
        }
      });
      // Return to video
      returnBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();

        quizContainer.style.display = "none";
        videoContainer.style.display = "block";
        videoEl.currentTime = 0;
        videoEl.play();
      });
      // Back to video list
      nextSectionBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();

        renderVideoList();
      });
    }

    /********************************************
     * EEG SLIDE GENERATOR FUNCTION
     ********************************************/
    function openEEGIndexApp() {
      const generatorHTML = `
      <div id="generator" style="max-width:400px; width:90%; margin:0 auto; box-shadow:0 4px 8px var(--shadow-color); border-radius:8px; overflow:hidden; background: var(--info-bg);">
        <header style="background: linear-gradient(135deg, #003366, #00509e); color: var(--header-text); padding:30px; text-align:center;">
          <h2 style="font-size:28px; margin:0;">EEG Slide Generator</h2>
        </header>
        <div class="content" style="padding:20px;">
          <form id="slideForm">
            <label for="fullName" style="font-size:20px; margin-top:15px;">Full Name:</label>
            <input type="text" id="fullName" placeholder="Enter your full name" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;">
            <label for="residency" style="font-size:20px; margin-top:15px;">Residency Program:</label>
            <input type="text" id="residency" placeholder="e.g. PGY-2 Neurology" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;">
            <label for="eegImage" style="font-size:20px; margin-top:15px;">Upload EEG Screenshot:</label>
            <input type="file" id="eegImage" accept="image/*" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;">
            <label for="patternDescription" style="font-size:20px; margin-top:15px;">Describe the EEG Pattern:</label>
            <textarea id="patternDescription" rows="4" placeholder="Enter the description of the pattern" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;"></textarea>
            <label for="additionalComments" style="font-size:20px; margin-top:15px;">Additional Comments (Optional):</label>
            <textarea id="additionalComments" rows="3" placeholder="Enter any additional comments" style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;"></textarea>
            <button type="submit" style="margin-top:20px; padding:16px; background: linear-gradient(135deg, #003366, #00509e); color: var(--header-text); border:none; border-radius:4px; width:100%; font-size:22px; cursor:pointer;">
              Generate PowerPoint Slide
            </button>
          </form>
        </div>
        <p class="footer-tip" style="text-align:center; font-size:16px; color: var(--text-color); margin-top:10px;">
          Tip: Run this page on a local web server and use PNG/JPG images.
        </p>
      </div>
      `;
      document.getElementById("section-content").innerHTML = generatorHTML;
      attachEEGSlideFormListener();
    }

    function attachEEGSlideFormListener() {
      document.getElementById("slideForm").addEventListener("submit", function(e) {
        e.preventDefault();
        const fullName = document.getElementById("fullName").value;
        const residency = document.getElementById("residency").value;
        const description = document.getElementById("patternDescription").value;
        const additionalComments = document.getElementById("additionalComments").value;
        const fileInput = document.getElementById("eegImage");
        const file = fileInput.files[0];
        if (!file) {
          alert("Please choose a PNG or JPG file first!");
          return;
        }
        const reader = new FileReader();
        reader.onload = function(event) {
          const imageData = event.target.result;
          try {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            slide.addText("EEG Slide Submission", {
              x: 0.5,
              y: 0.3,
              w: 9,
              fontSize: 24,
              bold: true,
              align: "center"
            });
            slide.addText(`Submitted by: ${fullName} (${residency})`, {
              x: 0.5,
              y: 1,
              w: 9,
              fontSize: 16,
              color: "555555",
              align: "center"
            });
            slide.addImage({ data: imageData, x: "3", y: "1.5", w: "4", h: "3" });
            slide.addText("EEG Pattern Description:", {
              x: 0.5,
              y: 4.8,
              w: 9,
              fontSize: 18,
              bold: true,
              color: "363636"
            });
            slide.addText(description, {
              x: 0.5,
              y: 5.3,
              w: 9,
              fontSize: 16,
              color: "363636"
            });
            if (additionalComments.trim() !== "") {
              slide.addText("Additional Comments:", {
                x: 0.5,
                y: 6.2,
                w: 9,
                fontSize: 18,
                bold: true,
                color: "363636"
              });
              slide.addText(additionalComments, {
                x: 0.5,
                y: 6.7,
                w: 9,
                fontSize: 16,
                color: "363636"
              });
            }
            pptx.writeFile({ fileName: "EEG_Slide.pptx" })
              .then(() => {
                alert("PowerPoint slide generated and downloaded!");
              })
              .catch((err) => {
                alert("Error generating PPT. Check console for details.");
              });
          } catch (err) {
            alert("An unexpected error occurred. Check console for details.");
          }
        };
        reader.readAsDataURL(file);
      });
    }

    // Initially load the default section (Epilepsy Rotation)
    renderSection();

    // Show the fixed footer on scroll
    const footer = document.getElementById("footer");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 300) {
        footer.classList.add("show-footer");
      } else {
        footer.classList.remove("show-footer");
      }
    });

    // Shrink header and fade out text as user scrolls
    window.addEventListener("scroll", () => {
      const header = document.getElementById("header");
      const scroll = window.scrollY;
      // If scrolled >100px, add "shrink"
      if (scroll > 100) {
        header.classList.add("shrink");
      } else {
        header.classList.remove("shrink");
      }
      // Fade out the h1/p from 1 -> 0 over the first 100px
      const fade = 1 - Math.min(scroll / 100, 1);
      header.querySelectorAll("h1, p").forEach(el => {
        el.style.opacity = fade;
      });
    });
  </script>
</body>
</html>