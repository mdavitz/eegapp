<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Responsive scaling -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="logo.png" />
  <link rel="apple-touch-icon" href="logo.png" />
  
  <!-- Open Graph meta tags -->
  <meta property="og:title" content="EEG Curriculum" />
  <meta property="og:description" content="Engaging Videos &amp; Self-Assessment Tools" />
  <meta property="og:image" content="https://example.com/logo.png" />
  <meta property="og:url" content="https://example.com" />
  
  <title>EEG Curriculum</title>
  
  <style>
    /*-----------------------------------------------
      THEME VARIABLES & TRANSITIONS
    -----------------------------------------------*/
    :root {
      --primary-color: #003366;
      --secondary-color: #00509e;
      --accent-color: #007bff;
      --bg-color: #fafafa;
      --text-color: #333;
      --info-bg: #fff;
      --border-color: #ddd;
      --header-text: #fff;
      --hover-bg: #f0f0f0;
      --shadow-color: rgba(0, 0, 0, 0.08);
      --table-header-bg: #f8f8f8;
      --dropdown-hover-bg: #f9f9f9;
      --transition-duration: 0.3s;
      --answer-bg: #e9ecef;
      --answer-hover-bg: #d6d8db;
    }
    .dark {
      --primary-color: #1a1a1a;
      --secondary-color: #333;
      --accent-color: #0099ff;
      --bg-color: #121212;
      --text-color: #eee;
      --info-bg: #1e1e1e;
      --border-color: #444;
      --header-text: #fff;
      --hover-bg: #222;
      --shadow-color: rgba(0, 0, 0, 0.3);
      --table-header-bg: #333;
      --dropdown-hover-bg: #2a2a2a;
      --answer-bg: #333;
      --answer-hover-bg: #444;
    }
    body.large-font { font-size: 1.2em; }

    /*-----------------------------------------------
      GLOBAL RESET & BASE STYLES
    -----------------------------------------------*/
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell,
                   "Open Sans", "Helvetica Neue", sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      transition: background var(--transition-duration),
                  color var(--transition-duration),
                  font-size var(--transition-duration);
      padding-bottom: 80px;
    }
    .step-image { display: block; margin: 0 auto; max-width: 100%; height: auto; }

    /*-----------------------------------------------
      HEADER (Centered container + Mobile vs Desktop)
    -----------------------------------------------*/
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(0, 51, 102, 0.6);
      backdrop-filter: blur(8px);
      box-shadow: 0 2px 6px var(--shadow-color);
      transition: padding 0.3s ease, backdrop-filter 0.3s ease;
    }
    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }
    header.shrink .header-inner { padding: 0.4rem 2rem; }
    .logo { width: 80px; height: auto; cursor: pointer; transition: width 0.3s, transform 0.3s; }
    header.shrink .logo { width: 60px; }
    .logo:hover { transform: scale(1.05); }
    .desktop-tabs { display: flex; gap: 1.5rem; align-items: center; }
    .desktop-tabs a {
      color: var(--header-text);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease, transform 0.3s;
    }
    .desktop-tabs a:hover { color: var(--accent-color); transform: scale(1.05); }
    .mobile-tabs {
      display: none;
      align-items: center;
      position: relative;
      gap: 1rem;
    }
    .mobile-tabs a {
      text-decoration: none;
      color: var(--header-text);
      font-weight: 500;
      padding: 0.5rem 1rem;
      transition: color 0.3s, transform 0.3s;
    }
    .mobile-tabs a:hover { color: var(--accent-color); transform: scale(1.05); }
    #current-mobile-tab { cursor: pointer; }
    .mobile-dropdown {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--info-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      box-shadow: 0 2px 6px var(--shadow-color);
      z-index: 2000;
      min-width: 150px;
    }
    .mobile-dropdown a {
      display: block;
      padding: 0.6rem 1rem;
      color: var(--text-color);
      text-decoration: none;
      transition: background 0.3s, transform 0.3s;
    }
    .mobile-dropdown a:hover { background: var(--hover-bg); transform: scale(1.02); }
    @media (max-width: 600px) { .desktop-tabs { display: none; } .mobile-tabs { display: flex; } }

    /*-----------------------------------------------
      MAIN CONTAINER
    -----------------------------------------------*/
    .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem 2rem; }
    @media (max-width: 600px) { .container { max-width: 95%; } }

    /*-----------------------------------------------
      HOMEPAGE CARDS
    -----------------------------------------------*/
    .cards-container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; text-align: center; }
    .cards-container h2 { margin-top: 1.5rem; margin-bottom: 1.5rem; font-size: 2rem; }
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    .card {
      display: flex;
      flex-direction: column;
      background: var(--info-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      text-align: center;
    }
    .card:hover { transform: translateY(-5px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .card i { font-size: 3rem; color: var(--accent-color); margin-bottom: 1rem; transition: transform 0.3s; }
    .card i:hover { transform: scale(1.1); }
    .card h3 { font-size: 1.5rem; margin-bottom: 0.75rem; }
    .card p { font-size: 1rem; margin-bottom: 1rem; line-height: 1.4; }
    .card a {
      margin-top: auto;
      display: inline-block;
      padding: 0.5rem 1rem;
      background: var(--accent-color);
      color: #fff;
      border-radius: 4px;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.3s ease, transform 0.3s;
    }
    .card a:hover { background: #0056b3; transform: scale(1.05); }

    /*-----------------------------------------------
      INFO BOXES & TABLES
    -----------------------------------------------*/
    .info-box {
      background: var(--info-bg);
      padding: 1.2em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      margin-bottom: 1.5em;
      transition: background var(--transition-duration);
    }
    .info-box h2 { margin-bottom: 0.75em; }
    .custom-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
      background-color: var(--info-bg);
      border: 1px solid var(--border-color);
      font-size: 1rem;
      border-radius: 8px;
      overflow: hidden;
      color: var(--text-color);
    }
    .custom-table thead tr { background-color: var(--table-header-bg); }
    .custom-table thead th { font-weight: 600; }
    .custom-table th, .custom-table td { padding: 16px; border-bottom: 1px solid var(--border-color); }
    .custom-table tr:hover td { background-color: var(--hover-bg); }
    .table-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4em;
      color: #007bff;
      font-weight: 500;
      text-decoration: none;
      border-radius: 4px;
      transition: background 0.2s, color 0.2s, transform 0.2s;
      margin-left: 0.5em;
    }
    .table-link:hover { text-decoration: underline; color: #0056b3; transform: scale(1.05); }
    table, th, td { border: 1px solid var(--border-color); }
    th, td { padding: 10px; text-align: left; }
    th { background-color: var(--table-header-bg); }
    .pm-workflow { background: var(--table-header-bg); }

    /*-----------------------------------------------
      VIDEO LIST & CONTAINER
    -----------------------------------------------*/
    .video-list {
      background: var(--info-bg);
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      margin-bottom: 1.5em;
    }
    .video-list h2 { margin-bottom: 0.75em; }
    .video-list ul { list-style: none; margin-top: 0.5em; }
    .video-list li {
      padding: 0.8em;
      cursor: pointer;
      border-bottom: 1px solid var(--border-color);
      transition: background var(--transition-duration), transform 0.3s;
    }
    .video-list li:hover { background: var(--hover-bg); transform: scale(1.02); }
    .video-container { text-align: center; margin-bottom: 1.5em; }
    video {
      width: 100%;
      max-width: 1000px;
      height: auto;
      border-radius: 8px;
      background-color: #000;
      border: 1px solid var(--border-color);
    }
    .skip-btn {
      padding: 0.75em 1.2em;
      font-size: 1rem;
      background-color: #28a745;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration), transform 0.3s;
    }
    .skip-btn:hover { background-color: #218838; transform: scale(1.05); }

    /*-----------------------------------------------
      QUIZ CONTAINER & FEEDBACK
    -----------------------------------------------*/
    .quiz-container {
      background: var(--info-bg);
      padding: 1.2em;
      border-radius: 8px;
      box-shadow: 0 4px 8px var(--shadow-color);
      display: none;
    }
    .quiz-container h2 {
      font-size: 1.15rem;
      margin-bottom: 0.75em;
      color: var(--text-color);
    }
    .progress-indicator {
      font-size: 0.9rem;
      color: var(--text-color);
      margin-bottom: 10px;
      text-align: right;
    }
    .answers button {
      display: block;
      width: 100%;
      padding: 0.8em;
      margin: 0.5em 0;
      font-size: 1rem;
      text-align: left;
      color: var(--text-color);
      background-color: var(--answer-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.1s, background var(--transition-duration);
    }
    .answers button:hover { transform: scale(1.02); background: var(--answer-hover-bg); }
    .feedback { width: 100%; margin-top: 0.75em; font-size: 1rem; min-height: 1.5em; }
    .correct-msg, .incorrect-msg { width: 100%; box-sizing: border-box; }
    .correct-msg {
      color: #155724;
      background-color: #d4edda;
      padding: 0.5em;
      border-radius: 4px;
      border: 1px solid #c3e6cb;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .incorrect-msg {
      color: #721c24;
      background-color: #f8d7da;
      padding: 0.5em;
      border-radius: 4px;
      border: 1px solid #f5c6cb;
    }
    .buttons-row {
      margin-top: 1em;
      display: flex;
      justify-content: space-between;
      gap: 1%;
    }
    .next-btn, .return-btn, .next-section-btn {
      width: 32%;
      padding: 0.8em;
      font-size: 1rem;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration), transform 0.3s;
      text-align: center;
    }
    .next-btn { background-color: var(--primary-color); }
    .next-btn:hover { background-color: #002147; transform: scale(1.05); }
    .return-btn { background-color: #6c757d; }
    .return-btn:hover { background-color: #5a6268; transform: scale(1.05); }
    .next-section-btn { background-color: #17a2b8; }
    .next-section-btn:hover { background-color: #138496; transform: scale(1.05); }
    .final-score { text-align: center; margin-top: 1em; font-size: 1.1rem; font-weight: bold; }

    @media (max-width: 600px) {
      .responsive-table thead { display: none; }
      .responsive-table, .responsive-table tbody, .responsive-table tr, .responsive-table td {
        display: block;
        width: 100%;
      }
      .responsive-table tr { margin-bottom: 1rem; border-bottom: 2px solid var(--border-color); }
      .responsive-table td {
        position: relative;
        padding-left: 50%;
        text-align: left;
        border: none;
        border-bottom: 1px solid var(--border-color);
      }
      .responsive-table td::before {
        content: attr(data-label);
        position: absolute;
        left: 0.8rem;
        width: 45%;
        font-weight: bold;
        white-space: nowrap;
      }
    }

    .kitten-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
      opacity: 1;
      transition: opacity 0.5s ease;
    }
    .kitten-overlay img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 50%;
    }

    #generator { position: relative; z-index: 0; }

    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: var(--info-bg);
      border-top: 1px solid var(--border-color);
      padding: 1em;
      text-align: center;
      z-index: 2000;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-duration);
    }
    footer.show-footer { opacity: 1; pointer-events: auto; }
    .footer-btns {
      display: inline-flex;
      gap: 1em;
      align-items: center;
    }
    .footer-btns button {
      background: var(--accent-color);
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 4px;
      cursor: pointer;
      transition: background var(--transition-duration), transform 0.3s;
      font-size: 0.9rem;
    }
    .footer-btns button:hover { background: #00509e; transform: scale(1.05); }

    .faq-section { padding: 1em; }
    .faq-section h2 { margin-bottom: 0.5em; text-align: center; }
    .faq-search-bar { margin-bottom: 1em; }
    .faq-search-bar input {
      width: 100%;
      padding: 0.5em;
      font-size: 1em;
      border: 1px solid var(--border-color);
      border-radius: 4px;
    }
    .faq-category { margin-bottom: 1.5em; }
    .faq-category h3 {
      margin-bottom: 0.5em;
      color: var(--secondary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.3em;
    }
    .faq-item { margin-bottom: 0.5em; }
    .faq-item summary {
      font-weight: 500;
      background: var(--info-bg);
      padding: 0.5em;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      cursor: pointer;
    }
    .faq-item summary:focus { outline: none; }
    .faq-item summary::marker { display: none; }
    .faq-item summary::before { content: "+"; font-weight: bold; margin-right: 0.5em; }
    .faq-item[open] summary::before { content: "-"; }
    .answer {
      padding: 0.5em 1em;
      background: var(--answer-bg);
      border: 1px solid var(--border-color);
      border-top: none;
      border-radius: 0 0 4px 4px;
    }
    mark { background-color: yellow; padding: 0 2px; }
    .legal-disclaimer {
      font-size: 0.9em;
      color: #666;
      text-align: center;
      margin-bottom: 1em;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 1em;
    }
    .legal-disclaimer strong { font-weight: bold; }
    #seizure-management ul.list {
      list-style-type: none;
      margin-left: 0;
      padding-left: 0;
    }
    #seizure-management .custom-table {
      width: 100%;
      display: block;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <!-- Login Container -->
  <div id="login-container" style="display: none; text-align: center; padding: 20px;">
    <h2>Please Sign In</h2>
    <button id="googleLoginButton">Sign in with Google</button>
    <button id="appleLoginButton">Sign in with Apple</button>
  </div>
  
  <!-- Main Content -->
  <div id="main-content" style="display: none;">
    <!-- HEADER -->
    <header id="header">
      <div class="header-inner">
        <img src="logo.png" alt="Home" class="logo" onclick="renderHomePage()" />
        <div class="desktop-tabs" id="desktop-tabs">
          <a href="#" onclick="navigateToSection(0)">Epilepsy Rotation</a>
          <a href="#" onclick="navigateToSection(1)">Seizure Management</a>
          <a href="#" onclick="navigateToSection(2)">Natus Instructions</a>
          <a href="#" onclick="navigateToSection(3)">ACNS Criteria</a>
          <a href="#" onclick="navigateToSection(4)">EEG Videos</a>
          <a href="#" onclick="navigateToSection(5)">FAQ</a>
        </div>
        <div class="mobile-tabs" id="mobile-tabs">
          <a href="#" id="current-mobile-tab" onclick="toggleMobileDropdown(event)">Epilepsy Rotation</a>
          <div class="mobile-dropdown" id="mobile-dropdown">
            <a href="#" onclick="renderHomePage(); hideMobileDropdown()">Home</a>
            <a href="#" onclick="navigateToSection(0)">Epilepsy Rotation</a>
            <a href="#" onclick="navigateToSection(1)">Seizure Management</a>
            <a href="#" onclick="navigateToSection(2)">Natus Instructions</a>
            <a href="#" onclick="navigateToSection(3)">ACNS Criteria</a>
            <a href="#" onclick="navigateToSection(4)">EEG Videos</a>
            <a href="#" onclick="navigateToSection(5)">FAQ</a>
          </div>
        </div>
      </div>
    </header>
    
    <!-- HOMEPAGE CARDS -->
    <div id="home-content" class="cards-container" style="display: none;">
      <h2>Explore the EEG Curriculum</h2>
      <div class="cards-grid">
        <div class="card">
          <i class="fa-solid fa-brain"></i>
          <h3>Epilepsy Rotation</h3>
          <p>Delve into daily expectations with engaging videos, quizzes, and guidelines for EEG readings and milestones.</p>
          <a href="#" onclick="navigateToSection(0)">Learn More</a>
        </div>
        <div class="card">
          <i class="fa-solid fa-file-medical"></i>
          <h3>Seizure Management</h3>
          <p>Access comprehensive guidelines on managing seizures—including status epilepticus protocols, ASM details, and refractory epilepsy strategies.</p>
          <a href="#" onclick="navigateToSection(1)">Learn More</a>
        </div>
        <div class="card">
          <i class="fa-solid fa-desktop"></i>
          <h3>Natus Instructions</h3>
          <p>Follow our step-by-step guide to launching Natus NeuroWorks, reviewing patient studies, and configuring the display.</p>
          <a href="#" onclick="navigateToSection(2)">Learn More</a>
        </div>
        <div class="card">
          <i class="fa-solid fa-file-pdf"></i>
          <h3>ACNS Criteria</h3>
          <p>Access detailed visual references and downloadable charts of ACNS guidelines to improve EEG interpretation.</p>
          <a href="#" onclick="navigateToSection(3)">Learn More</a>
        </div>
        <div class="card">
          <i class="fa-solid fa-video"></i>
          <h3>EEG Videos</h3>
          <p>Engage with interactive EEG videos accompanied by quizzes to sharpen your knowledge and interpretation skills.</p>
          <a href="#" onclick="navigateToSection(4)">Learn More</a>
        </div>
        <div class="card">
          <i class="fa-solid fa-circle-question"></i>
          <h3>FAQ</h3>
          <p>Find answers to common questions about EEG interpretation, seizure management, and epilepsy care.</p>
          <a href="#" onclick="navigateToSection(5)">Learn More</a>
        </div>
      </div>
    </div>
    
    <!-- MAIN CONTAINER -->
    <div class="container">
      <div id="section-content"></div>
    </div>
    
    <!-- FIXED FOOTER CONTROLS -->
    <footer id="footer">
      <div class="footer-btns">
        <button onclick="toggleFontSize()" aria-label="Toggle Font Size">
          <span style="font-size:1.4em;">A</span>/<span style="font-size:0.8em;">a</span>
        </button>
        <button onclick="toggleDarkMode()" aria-label="Toggle Dark Mode">Dark Mode</button>
      </div>
    </footer>
  </div>

  <!-- Firebase App & Auth (Compat libraries for non-module usage) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <script>
    /****************************************
     * Initialize Firebase (Compat)
     ****************************************/
    const firebaseConfig = {
      apiKey: "AIzaSyDhMhYzo2G0Efvj7zM0rwjJbEN4nIWZEgQ",
      authDomain: "eeg-app-6968e.firebaseapp.com",
      projectId: "eeg-app-6968e",
      storageBucket: "eeg-app-6968e.firebasestorage.app",
      messagingSenderId: "322977550023",
      appId: "1:322977550023:web:9f91e6ffd07d31c80578e2"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    /****************************************
     * Show/Hide Login vs. Main Content
     ****************************************/
    document.addEventListener("DOMContentLoaded", () => {
      const loginContainer = document.getElementById("login-container");
      const mainContent = document.getElementById("main-content");
      const googleButton = document.getElementById("googleLoginButton");
      const appleButton = document.getElementById("appleLoginButton");

      googleButton.addEventListener("click", loginWithGoogle);
      appleButton.addEventListener("click", loginWithApple);

      auth.onAuthStateChanged((user) => {
        if (user) {
          loginContainer.style.display = "none";
          mainContent.style.display = "block";
          console.log("User signed in:", user);
        } else {
          loginContainer.style.display = "block";
          mainContent.style.display = "none";
          console.log("No user signed in.");
        }
      });
    });

    function loginWithGoogle() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then((result) => {
          console.log("Signed in with Google:", result.user);
        })
        .catch((error) => {
          console.error("Google sign in error:", error);
        });
    }

    function loginWithApple() {
      const provider = new firebase.auth.OAuthProvider('apple.com');
      auth.signInWithPopup(provider)
        .then((result) => {
          console.log("Signed in with Apple:", result.user);
        })
        .catch((error) => {
          console.error("Apple sign in error:", error);
        });
    }

    /****************************************
     * Basic Page & Navigation Logic
     ****************************************/
    function toggleMobileDropdown(e) {
      e.preventDefault();
      const dropdown = document.getElementById("mobile-dropdown");
      dropdown.style.display = (dropdown.style.display === "block") ? "none" : "block";
    }
    function hideMobileDropdown() { document.getElementById("mobile-dropdown").style.display = "none"; }
    function setMobileTabLabel(label) { document.getElementById("current-mobile-tab").textContent = label; }

    function renderHomePage() {
      document.getElementById("section-content").innerHTML = "";
      document.getElementById("home-content").style.display = "block";
      setMobileTabLabel("Home");
      hideMobileDropdown();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    let currentSectionIndex = 0, currentVideoIndex = -1, currentQuestionIndex = 0, score = 0;

    // Check for PIN on Seizure Management tab
    function navigateToSection(index) {
      if (index === 1) {
        var pin = prompt("Enter PIN to access Seizure Management:");
        if (pin !== "4321") {
          alert("Incorrect PIN. Access Denied.");
          return;
        }
      }
      currentSectionIndex = index;
      document.getElementById("home-content").style.display = "none";
      renderSection();
      setMobileTabLabel(sections[index].title);
      hideMobileDropdown();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /****************************************
     * Full Video Sections
     ****************************************/
    const videoSections = [
      {
        title: "Introduction to EEG",
        video: "EEG1.mp4",
        questions: [
          {
            question: "Which of the following landmarks is NOT used for EEG electrode placement?",
            answers: [
              { text: "Nasion", feedback: "Incorrect. The nasion is standard." },
              { text: "Mandibular notch", feedback: "Correct. It’s not used." },
              { text: "Inion", feedback: "Incorrect. The inion is standard." },
              { text: "Pre-auricular point", feedback: "Incorrect. It’s standard." }
            ],
            correct: 1
          },
          {
            question: "Which term describes a single EEG tracing?",
            answers: [
              { text: "Channel", feedback: "Correct!" },
              { text: "Chain", feedback: "Incorrect." },
              { text: "Montage", feedback: "Incorrect." },
              { text: "Electrode", feedback: "Incorrect." }
            ],
            correct: 0
          },
          {
            question: "Which area is least likely to show an interictal abnormality on scalp EEG?",
            answers: [
              { text: "Right frontal convexity", feedback: "Incorrect." },
              { text: "Left temporal neocortex", feedback: "Incorrect." },
              { text: "Right parietal lobe", feedback: "Incorrect." },
              { text: "Left insular cortex", feedback: "Correct." }
            ],
            correct: 3
          }
        ]
      },
      {
        title: "Polarity Rules",
        video: "EEG2.mp4",
        questions: [
          {
            question: "Which term indicates the quality of a differential amplifier?",
            answers: [
              { text: "Low-pass filter", feedback: "Incorrect." },
              { text: "Common mode rejection ratio", feedback: "Correct." },
              { text: "High-pass filter", feedback: "Incorrect." },
              { text: "Time base", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "An upward deflection indicates which scenario?",
            answers: [
              { text: "Input 1 positive vs. Input 2", feedback: "Incorrect." },
              { text: "Input 2 negative vs. Input 1", feedback: "Incorrect." },
              { text: "Input 1 negative vs. Input 2", feedback: "Correct." },
              { text: "Input 1 positive vs. ground", feedback: "Incorrect." }
            ],
            correct: 2
          },
          {
            question: "What does a phase reversal on EEG indicate?",
            answers: [
              { text: "Maximal negativity", feedback: "Correct." },
              { text: "Polarity change (neg to pos)", feedback: "Incorrect." },
              { text: "Polarity change (pos to neg)", feedback: "Incorrect." },
              { text: "Frequency change", feedback: "Incorrect." }
            ],
            correct: 0
          }
        ]
      },
      {
        title: "Montages",
        video: "EEG3.mp4",
        questions: [
          {
            question: "Which montage is bipolar?",
            answers: [
              { text: "Laplacian", feedback: "Incorrect." },
              { text: "Transverse", feedback: "Correct." },
              { text: "Ipsilateral mastoid", feedback: "Incorrect." },
              { text: "Contralateral mastoid", feedback: "Incorrect." }
            ],
            correct: 1
          },
          {
            question: "Which montage is most susceptible to reference contamination?",
            answers: [
              { text: "Anterior-posterior bipolar", feedback: "Incorrect." },
              { text: "Laplacian", feedback: "Incorrect." },
              { text: "Ipsilateral mastoid", feedback: "Incorrect." },
              { text: "Common average reference", feedback: "Correct." }
            ],
            correct: 3
          },
          {
            question: "What is a disadvantage of the Laplacian montage?",
            answers: [
              { text: "Poor for focal waveforms", feedback: "Incorrect." },
              { text: "Poor for broadly-distributed waveforms", feedback: "Correct." },
              { text: "Susceptible to eye movement artifact", feedback: "Incorrect." },
              { text: "Susceptible to reference contamination", feedback: "Incorrect." }
            ],
            correct: 1
          }
        ]
      },
      // ... (Include the rest of your original videoSections array)
    ];

    /****************************************
     * Sections Array (Includes Seizure Management, etc.)
     ****************************************/
    const sections = [
      {
        title: "Epilepsy Rotation",
        type: "info",
        content: `<!-- Your original Epilepsy Rotation HTML (see above) -->`
      },
      {
        title: "Seizure Management",
        type: "info",
        content: `<!-- Your original Seizure Management HTML with disclaimers, tables, etc. -->`
      },
      {
        title: "Natus Instructions",
        type: "info",
        content: `<!-- Your original Natus Instructions content -->`
      },
      {
        title: "ACNS Criteria",
        type: "info",
        content: `<!-- Your original ACNS Criteria content -->`
      },
      {
        title: "EEG Videos",
        type: "videoGroup",
        videoSections: videoSections,
        reference: `
          <div class="curriculum-reference" style="margin-top:1em; text-align:center;">
            <p>
              <strong>Curriculum Reference:</strong> Moeller JJ, Farooque P, Leydon G, Dominguez M, Schwartz ML, Sadler RM. A video-based introductory EEG curriculum for neurology residents. <em>MedEdPORTAL</em>. 2017;13:10570.
              <a href="https://doi.org/10.15766/mep_2374-8265.10570" target="_blank">
                <i class="fa-solid fa-link"></i> Link
              </a>
            </p>
          </div>
        `,
      },
      {
        title: "EEG &amp; Seizure FAQ",
        type: "info",
        content: `<!-- Your original FAQ content with disclaimers, categories, etc. -->`
      }
    ];

    /****************************************
     * Render Section Function
     ****************************************/
    function renderSection() {
      const section = sections[currentSectionIndex];
      if (section.type === "info") {
        document.getElementById("section-content").innerHTML = section.content;
      } else if (section.type === "videoGroup") {
        renderVideoList();
      } else {
        document.getElementById("section-content").innerHTML = section.content;
      }
      // If it's Seizure Management, attach the search functionality
      if (section.title === "Seizure Management") {
        const searchBar = document.getElementById('searchBar');
        if (searchBar && !searchBar.getAttribute('data-listener-attached')) {
          searchBar.setAttribute('data-listener-attached', 'true');
          const detailsElements = document.querySelectorAll('#contentContainer details');
          detailsElements.forEach(function(detail) {
            detail.originalHTML = detail.innerHTML;
          });
          searchBar.addEventListener('input', function(e) {
            const term = e.target.value.trim();
            detailsElements.forEach(function(detail) {
              if (term === "") {
                detail.innerHTML = detail.originalHTML;
                detail.style.display = "";
              } else {
                const regex = new RegExp(term, 'i');
                if (regex.test(detail.originalHTML)) {
                  const highlightRegex = new RegExp('('+term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')+')', 'gi');
                  detail.innerHTML = detail.originalHTML.replace(highlightRegex, '<mark>$1</mark>');
                  detail.style.display = "";
                } else {
                  detail.style.display = "none";
                }
              }
            });
          });
        }
      }
    }

    /****************************************
     * Render Video List Function
     ****************************************/
    function renderVideoList() {
      const group = sections[currentSectionIndex];
      let html = `<div class="video-list"><h2>Select a Video Topic</h2><ul id="video-sub-list">`;
      group.videoSections.forEach((vid, i) => {
        html += `<li data-vid-index="${i}">${vid.title}</li>`;
      });
      html += `</ul></div>`;
      if (group.reference) { html += group.reference; }
      document.getElementById("section-content").innerHTML = html;
      const items = document.querySelectorAll("#video-sub-list li");
      items.forEach(item => {
        item.addEventListener("click", () => {
          currentVideoIndex = parseInt(item.getAttribute("data-vid-index"));
          currentQuestionIndex = 0;
          score = 0;
          renderVideoSection(currentVideoIndex);
        });
      });
    }

    /****************************************
     * Render Video Section Function
     ****************************************/
    function renderVideoSection(videoIdx) {
      const group = sections[currentSectionIndex];
      const vid = group.videoSections[videoIdx];
      document.getElementById("section-content").innerHTML = `
        <h2 style="text-align:center; margin-bottom:1em;">${vid.title}</h2>
        <div class="video-container" id="video-container">
          <video id="video" controls>
            <source src="${vid.video}" type="video/mp4" />
            Your browser does not support the video tag.
          </video>
          <br />
          <button class="skip-btn" id="skip-btn">Skip to Quiz</button>
        </div>
        <div class="quiz-container" id="quiz-container">
          <div class="progress-indicator" id="progress-indicator"></div>
          <div id="question-container"></div>
          <div class="feedback" id="feedback"></div>
          <div class="buttons-row">
            <button class="next-btn" id="next-btn" style="display:none;">Next</button>
            <button class="return-btn" id="return-btn">Return to Video</button>
            <button class="next-section-btn" id="next-section-btn" style="display:none;">Back to Video List</button>
          </div>
          <div class="final-score" id="final-score"></div>
        </div>
        ${group.reference || ""}
      `;
      setupVideoQuiz(vid);
    }

    /****************************************
     * Setup Video Quiz Function
     ****************************************/
    function setupVideoQuiz(vid) {
      const videoEl = document.getElementById("video");
      const videoContainer = document.getElementById("video-container");
      const skipBtn = document.getElementById("skip-btn");
      const quizContainer = document.getElementById("quiz-container");
      const questionContainer = document.getElementById("question-container");
      const feedbackDiv = document.getElementById("feedback");
      const progressIndicator = document.getElementById("progress-indicator");
      const nextBtn = document.getElementById("next-btn");
      const returnBtn = document.getElementById("return-btn");
      const nextSectionBtn = document.getElementById("next-section-btn");
      const finalScoreDiv = document.getElementById("final-score");

      currentQuestionIndex = 0;
      score = 0;
      quizContainer.style.display = "none";

      function showQuestion() {
        feedbackDiv.innerHTML = "";
        progressIndicator.textContent = `Question ${currentQuestionIndex + 1} of ${vid.questions.length}`;
        finalScoreDiv.textContent = "";
        const currentQ = vid.questions[currentQuestionIndex];
        questionContainer.innerHTML = `<h2 style="color: var(--text-color);">${currentQ.question}</h2>`;
        let correctChosen = false;
        const answersDiv = document.createElement("div");
        answersDiv.className = "answers";
        currentQ.answers.forEach((ansObj, idx) => {
          const btn = document.createElement("button");
          btn.textContent = ansObj.text;
          btn.addEventListener("click", () => {
            if (!correctChosen && idx === currentQ.correct) {
              correctChosen = true;
              score++;
              feedbackDiv.className = "correct-msg";
              feedbackDiv.textContent = ansObj.feedback;
              showKittenOverlay();
              if (currentQuestionIndex < vid.questions.length - 1) {
                nextBtn.style.display = "inline-block";
              } else {
                finalScoreDiv.textContent = `Your score: ${score} out of ${vid.questions.length}`;
                nextSectionBtn.textContent = "Back to Video List";
                nextSectionBtn.style.display = "inline-block";
              }
            } else if (idx === currentQ.correct) {
              feedbackDiv.className = "correct-msg";
              feedbackDiv.textContent = ansObj.feedback;
            } else {
              feedbackDiv.className = "incorrect-msg";
              feedbackDiv.textContent = ansObj.feedback;
            }
          });
          answersDiv.appendChild(btn);
        });
        questionContainer.appendChild(answersDiv);
      }

      videoEl.addEventListener("ended", () => {
        videoContainer.style.display = "none";
        quizContainer.style.display = "block";
        showQuestion();
      });
      skipBtn.addEventListener("click", () => {
        videoEl.pause();
        videoContainer.style.display = "none";
        quizContainer.style.display = "block";
        showQuestion();
      });
      nextBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();
        currentQuestionIndex++;
        if (currentQuestionIndex < vid.questions.length) {
          showQuestion();
        }
      });
      returnBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();
        quizContainer.style.display = "none";
        videoContainer.style.display = "block";
        videoEl.currentTime = 0;
        videoEl.play();
      });
      nextSectionBtn.addEventListener("click", () => {
        const overlay = document.querySelector(".kitten-overlay");
        if (overlay) overlay.remove();
        renderVideoList();
      });
    }

    /****************************************
     * ShowKittenOverlay Function
     ****************************************/
    function showKittenOverlay() {
      const overlay = document.createElement("div");
      overlay.className = "kitten-overlay";
      overlay.addEventListener("click", () => overlay.remove());
      const randomParam = Date.now();
      const catImg = document.createElement("img");
      catImg.src = `https://cataas.com/cat/gif?${randomParam}`;
      catImg.alt = "Kitten Celebration!";
      overlay.appendChild(catImg);
      document.body.appendChild(overlay);
    }

    /****************************************
     * EEG Slide Generator
     ****************************************/
    function openEEGIndexApp() {
      const generatorHTML = `
        <div id="generator" style="max-width:400px; width:90%; margin:0 auto; box-shadow:0 4px 8px var(--shadow-color); border-radius:8px; overflow:hidden; background: var(--info-bg);">
          <header style="background: linear-gradient(135deg, #003366, #00509e); color: var(--header-text); padding:30px; text-align:center;">
            <h2 style="font-size:28px; margin:0;">EEG Slide Generator</h2>
          </header>
          <div class="content" style="padding:20px;">
            <form id="slideForm">
              <label for="fullName" style="font-size:20px; margin-top:15px;">Full Name:</label>
              <input type="text" id="fullName" placeholder="Enter your full name" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;">
              <label for="residency" style="font-size:20px; margin-top:15px;">Residency Program:</label>
              <input type="text" id="residency" placeholder="e.g. PGY-2 Neurology" required style="width:100%; padding:14px; font-size:20px; border:1px solid var(--border-color); border-radius:4px; margin-top:5px;">
              <label for="eegImage" style="font-size:20px; margin-top:15px;">Upload EEG Screenshot:</label>
              <input type="file" id="eegImage" accept="image/*" required style="width:100%; padding:14px; font-size:20px;">
            </form>
          </div>
        </div>
      `;
      document.getElementById("section-content").innerHTML = generatorHTML;
    }

    /****************************************
     * FAQ Filter
     ****************************************/
    function filterFaq() {
      var input = document.getElementById('faqSearch');
      var filter = input.value.toLowerCase();
      var faqList = document.getElementById('faq-list');
      var details = faqList.getElementsByTagName('details');
      for (var i = 0; i < details.length; i++) {
        var summaryText = details[i].getElementsByTagName('summary')[0].textContent;
        if (summaryText.toLowerCase().indexOf(filter) > -1) {
          details[i].style.display = "";
        } else {
          details[i].style.display = "none";
        }
      }
    }

    /****************************************
     * On Window Load: Render Home
     ****************************************/
    window.addEventListener("load", () => {
      renderHomePage();
    });

    /****************************************
     * Dark Mode & Font Size
     ****************************************/
    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }
    function toggleFontSize() {
      document.body.classList.toggle("large-font");
    }
    
    /****************************************
     * Show Footer on Scroll
     ****************************************/
    window.addEventListener("scroll", () => {
      const footer = document.getElementById("footer");
      if (window.scrollY > 300) {
        footer.classList.add("show-footer");
      } else {
        footer.classList.remove("show-footer");
      }
    });
  </script>
</body>
</html>